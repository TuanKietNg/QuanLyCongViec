{"remainingRequest":"D:\\TTTN2023\\Code\\QuanLyCongViec\\FE\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\TTTN2023\\Code\\QuanLyCongViec\\FE\\src\\pages\\role\\addPermissions.vue?vue&type=style&index=0&id=45f91308&lang=css&","dependencies":[{"path":"D:\\TTTN2023\\Code\\QuanLyCongViec\\FE\\src\\pages\\role\\addPermissions.vue","mtime":1704440180000},{"path":"D:\\TTTN2023\\Code\\QuanLyCongViec\\FE\\node_modules\\css-loader\\dist\\cjs.js","mtime":1704332100000},{"path":"D:\\TTTN2023\\Code\\QuanLyCongViec\\FE\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1704440418000},{"path":"D:\\TTTN2023\\Code\\QuanLyCongViec\\FE\\node_modules\\postcss-loader\\src\\index.js","mtime":1704332100000},{"path":"D:\\TTTN2023\\Code\\QuanLyCongViec\\FE\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1704332086000},{"path":"D:\\TTTN2023\\Code\\QuanLyCongViec\\FE\\node_modules\\vue-loader\\lib\\index.js","mtime":1704440418000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouaGlkZGVuLXNvcnRhYmxlOmFmdGVyLCAuaGlkZGVuLXNvcnRhYmxlOmJlZm9yZSB7DQogIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsNCn0NCi50YWJsZT50Ym9keT4gdHIgPnRkew0KICBwYWRkaW5nOiAwcHg7DQogIGxpbmUtaGVpZ2h0OiAzMHB4Ow0KfQ0K"},{"version":3,"sources":["addPermissions.vue"],"names":[],"mappings":";AAiMA;AACA;AACA;AACA;AACA;AACA;AACA","file":"addPermissions.vue","sourceRoot":"src/pages/role","sourcesContent":["<script>\r\nimport Layout from \"../../layouts/main\";\r\nimport PageHeader from \"@/components/page-header\";\r\nimport appConfig from \"@/app.config\";\r\nimport {notifyModel} from \"@/models/notifyModel\";\r\nexport default {\r\n  page: {\r\n    title: \"Thêm quyền vào vai trò\",\r\n    meta: [{name: \"description\", content: appConfig.description}],\r\n  },\r\n  components: {Layout, PageHeader},\r\n  data() {\r\n    return {\r\n      node: [],\r\n      model : null ,\r\n      title: \"Thiết lập quyền\",\r\n      items: [\r\n        {\r\n          text: \"Vai trò\",\r\n          active: true,\r\n        },\r\n        {\r\n          text: \"Thêm quyền\",\r\n          active: true,\r\n        }\r\n      ],\r\n      showModal: false,\r\n      showDeleteModal: false,\r\n      submitted: false,\r\n      treeView: [],\r\n      itemEvents: {\r\n        mouseover: function () {\r\n\r\n        },\r\n        contextmenu: function () {\r\n          arguments[2].preventDefault()\r\n        }\r\n      },\r\n      fields: [\r\n        {\r\n          key: 'STT',\r\n          label: 'STT',\r\n          class: 'text-center',\r\n          thStyle: {width: '30px', minWidth: '30px'},\r\n           thClass: 'hidden-sortable'\r\n        },\r\n        {\r\n          key: \"name\",\r\n          label: \"Tên\",\r\n          class: \"text-center\",\r\n          thStyle: {width: '80px', minWidth: '80px'},\r\n          thClass: 'hidden-sortable'\r\n        },\r\n        {\r\n          key: \"action\",\r\n          label: \"Hành động\",\r\n          class: \"text-center\",\r\n          thStyle: {width: '80px', minWidth: '80px'},\r\n          thClass: 'hidden-sortable'\r\n        },\r\n        {\r\n          key: 'process',\r\n          label: 'Xử lý',\r\n          class: 'text-center',\r\n          thStyle: {width: '10px', minWidth: '10px'},\r\n          thClass: 'hidden-sortable'\r\n        }\r\n      ],\r\n    };\r\n  },\r\n  created() {\r\n    this.GetTreeList();\r\n    this.GetPermissionsByRoleId();\r\n  },\r\n  methods: {\r\n    async GetTreeList(){\r\n      await this.$store.dispatch(\"moduleStore/getAll\").then((res) => {\r\n            if (res.code === 0)\r\n            {\r\n              res.data.forEach(elements => this.treeView.push(elements))\r\n              //res.data\r\n            }\r\n      })\r\n    },\r\n    async itemClick (node) {\r\n      this.node = node.model\r\n      console.log(\"LOG CLICK : \", this.node)\r\n    },\r\n    async GetPermissionsByRoleId() {\r\n      await this.$store.dispatch(\"roleStore/getById\", this.$route.params.id).then((res) => {\r\n        if (res.code === 0) {\r\n               this.model = res.data;\r\n       //   console.log(\"LOG LIST : \" , this.model)\r\n        } else {\r\n          this.$store.dispatch(\"snackBarStore/addNotify\", notifyModel.addMessage(res));\r\n        }\r\n      });\r\n    },\r\n    statusPermission(permission) {\r\n      let check = this.model.permissions.findIndex(x => x.id == permission.id);\r\n      if (check == undefined || check == -1 )\r\n      {\r\n        return  false;\r\n      }\r\n      return true\r\n    },\r\n    onChecked(item) {\r\n      console.log(\"LOG item : \" , item)\r\n      let check = this.model.permissions.findIndex(x => x.id == item.id);\r\n      if (check == undefined || check == -1 )\r\n      {\r\n        this.model.permissions.push({id: item.id, name: item.name, action: item.action})\r\n        console.log(\"LOG IF NE : \" , this.model.permissions)\r\n      }else {\r\n        this.model.permissions = this.model.permissions?.filter(x => {\r\n          if (x.id != item.id)\r\n            return x;\r\n        });\r\n        console.log(\"LOG ELSE NE : \" , this.model.permissions)\r\n      }\r\n     // console.log(\"LOG GIA TRI PERMISSIONS :  \", this.model.permissions)\r\n    },\r\n    async handleSubmitRole() {\r\n      await this.$store.dispatch(\"roleStore/update\", this.model).then((res) => {\r\n        if (res.code === 0) {\r\n          this.$store.dispatch(\"snackBarStore/addNotify\", notifyModel.addMessage(res));\r\n        }\r\n      })\r\n    }\r\n  },\r\n};\r\n</script>\r\n<template>\r\n  <Layout>\r\n    <PageHeader   :title=\"title\" :items=\"items\"/>\r\n     <div class=\"row\">\r\n       <div class=\"col-lg-11\">\r\n       </div>\r\n       <div class=\"col-1\">\r\n         <b-button\r\n             type=\"button \"\r\n             class=\"btn-label mb-3 me-2 cs-btn-primary\"\r\n             @click=\"handleSubmitRole\" size=\"xl\"\r\n             v-if=\"$can('save-permission')\"\r\n         >\r\n           <i class=\"mdi mdi-plus me-1 label-icon\"></i> Lưu\r\n         </b-button>\r\n       </div>\r\n     </div>\r\n    <div class=\"row\">\r\n      <div class=\"col-4\">\r\n        <div class=\"card\">\r\n          <div class=\"card-body\">\r\n            <div class=\"font-weight-bold text-danger\" style=\"margin-bottom: 5px\" >\r\n              {{this.model.ten}}\r\n            </div>\r\n            <v-jstree  :data = \"treeView\"  text-field-name = \"name\" @item-click=\"itemClick\"></v-jstree>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"col-8\">\r\n        <div class=\"card\">\r\n          <div class=\"card-body\">\r\n            <h4 class=\" text-danger font-weight-bold font-size-20\">{{this.node.name}}</h4>\r\n            <b-table\r\n                class=\"datatables\"\r\n                :items=\"this.node.permissions\"\r\n                :fields=\"fields\"\r\n                striped\r\n                bordered\r\n                responsive=\"sm\">\r\n            <template v-slot:cell(STT)=\"data\">\r\n              {{ data.index + ((currentPage-1)*perPage) + 1  }}\r\n            </template>\r\n              <template v-slot:cell(process)=\"data\">\r\n                <div class=\"form-check form-check-danger\">\r\n                  <input\r\n                      class=\"form-check-input\"\r\n                      type=\"checkbox\"\r\n                      id=\"formCheckcolor1\"\r\n                      :checked=\"statusPermission(data.item)\"\r\n                      @click = \"onChecked(data.item)\"\r\n                  />\r\n                </div>\r\n              </template>\r\n            </b-table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </Layout>\r\n</template>\r\n<style>\r\n.hidden-sortable:after, .hidden-sortable:before {\r\n  display: none !important;\r\n}\r\n.table>tbody> tr >td{\r\n  padding: 0px;\r\n  line-height: 30px;\r\n}\r\n</style>\r\n"]}]}