{"remainingRequest":"D:\\TTTN2023\\Code\\QuanLyCongViec\\FE\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\TTTN2023\\Code\\QuanLyCongViec\\FE\\src\\pages\\role\\addPermissions.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\TTTN2023\\Code\\QuanLyCongViec\\FE\\src\\pages\\role\\addPermissions.vue","mtime":1704440180000},{"path":"D:\\TTTN2023\\Code\\QuanLyCongViec\\FE\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1704332086000},{"path":"D:\\TTTN2023\\Code\\QuanLyCongViec\\FE\\node_modules\\babel-loader\\lib\\index.js","mtime":1704440412000},{"path":"D:\\TTTN2023\\Code\\QuanLyCongViec\\FE\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1704332086000},{"path":"D:\\TTTN2023\\Code\\QuanLyCongViec\\FE\\node_modules\\vue-loader\\lib\\index.js","mtime":1704440418000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgTGF5b3V0IGZyb20gIi4uLy4uL2xheW91dHMvbWFpbiI7DQppbXBvcnQgUGFnZUhlYWRlciBmcm9tICJAL2NvbXBvbmVudHMvcGFnZS1oZWFkZXIiOw0KaW1wb3J0IGFwcENvbmZpZyBmcm9tICJAL2FwcC5jb25maWciOw0KaW1wb3J0IHtub3RpZnlNb2RlbH0gZnJvbSAiQC9tb2RlbHMvbm90aWZ5TW9kZWwiOw0KZXhwb3J0IGRlZmF1bHQgew0KICBwYWdlOiB7DQogICAgdGl0bGU6ICJUaMOqbSBxdXnhu4FuIHbDoG8gdmFpIHRyw7IiLA0KICAgIG1ldGE6IFt7bmFtZTogImRlc2NyaXB0aW9uIiwgY29udGVudDogYXBwQ29uZmlnLmRlc2NyaXB0aW9ufV0sDQogIH0sDQogIGNvbXBvbmVudHM6IHtMYXlvdXQsIFBhZ2VIZWFkZXJ9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBub2RlOiBbXSwNCiAgICAgIG1vZGVsIDogbnVsbCAsDQogICAgICB0aXRsZTogIlRoaeG6v3QgbOG6rXAgcXV54buBbiIsDQogICAgICBpdGVtczogWw0KICAgICAgICB7DQogICAgICAgICAgdGV4dDogIlZhaSB0csOyIiwNCiAgICAgICAgICBhY3RpdmU6IHRydWUsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICB0ZXh0OiAiVGjDqm0gcXV54buBbiIsDQogICAgICAgICAgYWN0aXZlOiB0cnVlLA0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgc2hvd01vZGFsOiBmYWxzZSwNCiAgICAgIHNob3dEZWxldGVNb2RhbDogZmFsc2UsDQogICAgICBzdWJtaXR0ZWQ6IGZhbHNlLA0KICAgICAgdHJlZVZpZXc6IFtdLA0KICAgICAgaXRlbUV2ZW50czogew0KICAgICAgICBtb3VzZW92ZXI6IGZ1bmN0aW9uICgpIHsNCg0KICAgICAgICB9LA0KICAgICAgICBjb250ZXh0bWVudTogZnVuY3Rpb24gKCkgew0KICAgICAgICAgIGFyZ3VtZW50c1syXS5wcmV2ZW50RGVmYXVsdCgpDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICBmaWVsZHM6IFsNCiAgICAgICAgew0KICAgICAgICAgIGtleTogJ1NUVCcsDQogICAgICAgICAgbGFiZWw6ICdTVFQnLA0KICAgICAgICAgIGNsYXNzOiAndGV4dC1jZW50ZXInLA0KICAgICAgICAgIHRoU3R5bGU6IHt3aWR0aDogJzMwcHgnLCBtaW5XaWR0aDogJzMwcHgnfSwNCiAgICAgICAgICAgdGhDbGFzczogJ2hpZGRlbi1zb3J0YWJsZScNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGtleTogIm5hbWUiLA0KICAgICAgICAgIGxhYmVsOiAiVMOqbiIsDQogICAgICAgICAgY2xhc3M6ICJ0ZXh0LWNlbnRlciIsDQogICAgICAgICAgdGhTdHlsZToge3dpZHRoOiAnODBweCcsIG1pbldpZHRoOiAnODBweCd9LA0KICAgICAgICAgIHRoQ2xhc3M6ICdoaWRkZW4tc29ydGFibGUnDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBrZXk6ICJhY3Rpb24iLA0KICAgICAgICAgIGxhYmVsOiAiSMOgbmggxJHhu5luZyIsDQogICAgICAgICAgY2xhc3M6ICJ0ZXh0LWNlbnRlciIsDQogICAgICAgICAgdGhTdHlsZToge3dpZHRoOiAnODBweCcsIG1pbldpZHRoOiAnODBweCd9LA0KICAgICAgICAgIHRoQ2xhc3M6ICdoaWRkZW4tc29ydGFibGUnDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBrZXk6ICdwcm9jZXNzJywNCiAgICAgICAgICBsYWJlbDogJ1jhu60gbMO9JywNCiAgICAgICAgICBjbGFzczogJ3RleHQtY2VudGVyJywNCiAgICAgICAgICB0aFN0eWxlOiB7d2lkdGg6ICcxMHB4JywgbWluV2lkdGg6ICcxMHB4J30sDQogICAgICAgICAgdGhDbGFzczogJ2hpZGRlbi1zb3J0YWJsZScNCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICB9Ow0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIHRoaXMuR2V0VHJlZUxpc3QoKTsNCiAgICB0aGlzLkdldFBlcm1pc3Npb25zQnlSb2xlSWQoKTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGFzeW5jIEdldFRyZWVMaXN0KCl7DQogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgibW9kdWxlU3RvcmUvZ2V0QWxsIikudGhlbigocmVzKSA9PiB7DQogICAgICAgICAgICBpZiAocmVzLmNvZGUgPT09IDApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIHJlcy5kYXRhLmZvckVhY2goZWxlbWVudHMgPT4gdGhpcy50cmVlVmlldy5wdXNoKGVsZW1lbnRzKSkNCiAgICAgICAgICAgICAgLy9yZXMuZGF0YQ0KICAgICAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9LA0KICAgIGFzeW5jIGl0ZW1DbGljayAobm9kZSkgew0KICAgICAgdGhpcy5ub2RlID0gbm9kZS5tb2RlbA0KICAgICAgY29uc29sZS5sb2coIkxPRyBDTElDSyA6ICIsIHRoaXMubm9kZSkNCiAgICB9LA0KICAgIGFzeW5jIEdldFBlcm1pc3Npb25zQnlSb2xlSWQoKSB7DQogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgicm9sZVN0b3JlL2dldEJ5SWQiLCB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQpLnRoZW4oKHJlcykgPT4gew0KICAgICAgICBpZiAocmVzLmNvZGUgPT09IDApIHsNCiAgICAgICAgICAgICAgIHRoaXMubW9kZWwgPSByZXMuZGF0YTsNCiAgICAgICAvLyAgIGNvbnNvbGUubG9nKCJMT0cgTElTVCA6ICIgLCB0aGlzLm1vZGVsKQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJzbmFja0JhclN0b3JlL2FkZE5vdGlmeSIsIG5vdGlmeU1vZGVsLmFkZE1lc3NhZ2UocmVzKSk7DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgIH0sDQogICAgc3RhdHVzUGVybWlzc2lvbihwZXJtaXNzaW9uKSB7DQogICAgICBsZXQgY2hlY2sgPSB0aGlzLm1vZGVsLnBlcm1pc3Npb25zLmZpbmRJbmRleCh4ID0+IHguaWQgPT0gcGVybWlzc2lvbi5pZCk7DQogICAgICBpZiAoY2hlY2sgPT0gdW5kZWZpbmVkIHx8IGNoZWNrID09IC0xICkNCiAgICAgIHsNCiAgICAgICAgcmV0dXJuICBmYWxzZTsNCiAgICAgIH0NCiAgICAgIHJldHVybiB0cnVlDQogICAgfSwNCiAgICBvbkNoZWNrZWQoaXRlbSkgew0KICAgICAgY29uc29sZS5sb2coIkxPRyBpdGVtIDogIiAsIGl0ZW0pDQogICAgICBsZXQgY2hlY2sgPSB0aGlzLm1vZGVsLnBlcm1pc3Npb25zLmZpbmRJbmRleCh4ID0+IHguaWQgPT0gaXRlbS5pZCk7DQogICAgICBpZiAoY2hlY2sgPT0gdW5kZWZpbmVkIHx8IGNoZWNrID09IC0xICkNCiAgICAgIHsNCiAgICAgICAgdGhpcy5tb2RlbC5wZXJtaXNzaW9ucy5wdXNoKHtpZDogaXRlbS5pZCwgbmFtZTogaXRlbS5uYW1lLCBhY3Rpb246IGl0ZW0uYWN0aW9ufSkNCiAgICAgICAgY29uc29sZS5sb2coIkxPRyBJRiBORSA6ICIgLCB0aGlzLm1vZGVsLnBlcm1pc3Npb25zKQ0KICAgICAgfWVsc2Ugew0KICAgICAgICB0aGlzLm1vZGVsLnBlcm1pc3Npb25zID0gdGhpcy5tb2RlbC5wZXJtaXNzaW9ucz8uZmlsdGVyKHggPT4gew0KICAgICAgICAgIGlmICh4LmlkICE9IGl0ZW0uaWQpDQogICAgICAgICAgICByZXR1cm4geDsNCiAgICAgICAgfSk7DQogICAgICAgIGNvbnNvbGUubG9nKCJMT0cgRUxTRSBORSA6ICIgLCB0aGlzLm1vZGVsLnBlcm1pc3Npb25zKQ0KICAgICAgfQ0KICAgICAvLyBjb25zb2xlLmxvZygiTE9HIEdJQSBUUkkgUEVSTUlTU0lPTlMgOiAgIiwgdGhpcy5tb2RlbC5wZXJtaXNzaW9ucykNCiAgICB9LA0KICAgIGFzeW5jIGhhbmRsZVN1Ym1pdFJvbGUoKSB7DQogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgicm9sZVN0b3JlL3VwZGF0ZSIsIHRoaXMubW9kZWwpLnRoZW4oKHJlcykgPT4gew0KICAgICAgICBpZiAocmVzLmNvZGUgPT09IDApIHsNCiAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgic25hY2tCYXJTdG9yZS9hZGROb3RpZnkiLCBub3RpZnlNb2RlbC5hZGRNZXNzYWdlKHJlcykpOw0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0NCiAgfSwNCn07DQo="},{"version":3,"sources":["addPermissions.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"addPermissions.vue","sourceRoot":"src/pages/role","sourcesContent":["<script>\r\nimport Layout from \"../../layouts/main\";\r\nimport PageHeader from \"@/components/page-header\";\r\nimport appConfig from \"@/app.config\";\r\nimport {notifyModel} from \"@/models/notifyModel\";\r\nexport default {\r\n  page: {\r\n    title: \"Thêm quyền vào vai trò\",\r\n    meta: [{name: \"description\", content: appConfig.description}],\r\n  },\r\n  components: {Layout, PageHeader},\r\n  data() {\r\n    return {\r\n      node: [],\r\n      model : null ,\r\n      title: \"Thiết lập quyền\",\r\n      items: [\r\n        {\r\n          text: \"Vai trò\",\r\n          active: true,\r\n        },\r\n        {\r\n          text: \"Thêm quyền\",\r\n          active: true,\r\n        }\r\n      ],\r\n      showModal: false,\r\n      showDeleteModal: false,\r\n      submitted: false,\r\n      treeView: [],\r\n      itemEvents: {\r\n        mouseover: function () {\r\n\r\n        },\r\n        contextmenu: function () {\r\n          arguments[2].preventDefault()\r\n        }\r\n      },\r\n      fields: [\r\n        {\r\n          key: 'STT',\r\n          label: 'STT',\r\n          class: 'text-center',\r\n          thStyle: {width: '30px', minWidth: '30px'},\r\n           thClass: 'hidden-sortable'\r\n        },\r\n        {\r\n          key: \"name\",\r\n          label: \"Tên\",\r\n          class: \"text-center\",\r\n          thStyle: {width: '80px', minWidth: '80px'},\r\n          thClass: 'hidden-sortable'\r\n        },\r\n        {\r\n          key: \"action\",\r\n          label: \"Hành động\",\r\n          class: \"text-center\",\r\n          thStyle: {width: '80px', minWidth: '80px'},\r\n          thClass: 'hidden-sortable'\r\n        },\r\n        {\r\n          key: 'process',\r\n          label: 'Xử lý',\r\n          class: 'text-center',\r\n          thStyle: {width: '10px', minWidth: '10px'},\r\n          thClass: 'hidden-sortable'\r\n        }\r\n      ],\r\n    };\r\n  },\r\n  created() {\r\n    this.GetTreeList();\r\n    this.GetPermissionsByRoleId();\r\n  },\r\n  methods: {\r\n    async GetTreeList(){\r\n      await this.$store.dispatch(\"moduleStore/getAll\").then((res) => {\r\n            if (res.code === 0)\r\n            {\r\n              res.data.forEach(elements => this.treeView.push(elements))\r\n              //res.data\r\n            }\r\n      })\r\n    },\r\n    async itemClick (node) {\r\n      this.node = node.model\r\n      console.log(\"LOG CLICK : \", this.node)\r\n    },\r\n    async GetPermissionsByRoleId() {\r\n      await this.$store.dispatch(\"roleStore/getById\", this.$route.params.id).then((res) => {\r\n        if (res.code === 0) {\r\n               this.model = res.data;\r\n       //   console.log(\"LOG LIST : \" , this.model)\r\n        } else {\r\n          this.$store.dispatch(\"snackBarStore/addNotify\", notifyModel.addMessage(res));\r\n        }\r\n      });\r\n    },\r\n    statusPermission(permission) {\r\n      let check = this.model.permissions.findIndex(x => x.id == permission.id);\r\n      if (check == undefined || check == -1 )\r\n      {\r\n        return  false;\r\n      }\r\n      return true\r\n    },\r\n    onChecked(item) {\r\n      console.log(\"LOG item : \" , item)\r\n      let check = this.model.permissions.findIndex(x => x.id == item.id);\r\n      if (check == undefined || check == -1 )\r\n      {\r\n        this.model.permissions.push({id: item.id, name: item.name, action: item.action})\r\n        console.log(\"LOG IF NE : \" , this.model.permissions)\r\n      }else {\r\n        this.model.permissions = this.model.permissions?.filter(x => {\r\n          if (x.id != item.id)\r\n            return x;\r\n        });\r\n        console.log(\"LOG ELSE NE : \" , this.model.permissions)\r\n      }\r\n     // console.log(\"LOG GIA TRI PERMISSIONS :  \", this.model.permissions)\r\n    },\r\n    async handleSubmitRole() {\r\n      await this.$store.dispatch(\"roleStore/update\", this.model).then((res) => {\r\n        if (res.code === 0) {\r\n          this.$store.dispatch(\"snackBarStore/addNotify\", notifyModel.addMessage(res));\r\n        }\r\n      })\r\n    }\r\n  },\r\n};\r\n</script>\r\n<template>\r\n  <Layout>\r\n    <PageHeader   :title=\"title\" :items=\"items\"/>\r\n     <div class=\"row\">\r\n       <div class=\"col-lg-11\">\r\n       </div>\r\n       <div class=\"col-1\">\r\n         <b-button\r\n             type=\"button \"\r\n             class=\"btn-label mb-3 me-2 cs-btn-primary\"\r\n             @click=\"handleSubmitRole\" size=\"xl\"\r\n             v-if=\"$can('save-permission')\"\r\n         >\r\n           <i class=\"mdi mdi-plus me-1 label-icon\"></i> Lưu\r\n         </b-button>\r\n       </div>\r\n     </div>\r\n    <div class=\"row\">\r\n      <div class=\"col-4\">\r\n        <div class=\"card\">\r\n          <div class=\"card-body\">\r\n            <div class=\"font-weight-bold text-danger\" style=\"margin-bottom: 5px\" >\r\n              {{this.model.ten}}\r\n            </div>\r\n            <v-jstree  :data = \"treeView\"  text-field-name = \"name\" @item-click=\"itemClick\"></v-jstree>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"col-8\">\r\n        <div class=\"card\">\r\n          <div class=\"card-body\">\r\n            <h4 class=\" text-danger font-weight-bold font-size-20\">{{this.node.name}}</h4>\r\n            <b-table\r\n                class=\"datatables\"\r\n                :items=\"this.node.permissions\"\r\n                :fields=\"fields\"\r\n                striped\r\n                bordered\r\n                responsive=\"sm\">\r\n            <template v-slot:cell(STT)=\"data\">\r\n              {{ data.index + ((currentPage-1)*perPage) + 1  }}\r\n            </template>\r\n              <template v-slot:cell(process)=\"data\">\r\n                <div class=\"form-check form-check-danger\">\r\n                  <input\r\n                      class=\"form-check-input\"\r\n                      type=\"checkbox\"\r\n                      id=\"formCheckcolor1\"\r\n                      :checked=\"statusPermission(data.item)\"\r\n                      @click = \"onChecked(data.item)\"\r\n                  />\r\n                </div>\r\n              </template>\r\n            </b-table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </Layout>\r\n</template>\r\n<style>\r\n.hidden-sortable:after, .hidden-sortable:before {\r\n  display: none !important;\r\n}\r\n.table>tbody> tr >td{\r\n  padding: 0px;\r\n  line-height: 30px;\r\n}\r\n</style>\r\n"]}]}